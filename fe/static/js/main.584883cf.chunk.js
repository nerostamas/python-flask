(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{206:function(e,t,a){e.exports=a(413)},211:function(e,t,a){},413:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(3),c=a.n(l),o=(a(211),a(8)),i=a(11),s=a(15),u=a(12),m=a(29),d=a(56),p=(a(63),a(21)),h=(a(144),a(61)),f=(a(89),a(13)),E=(a(90),a(34)),v=(a(75),a(23)),y=(a(145),a(35)),b=a(415),g=a(18),k=a.n(g),w=function(e,t){return k.a.post("/api/auth/login",{username:e,password:t}).then((function(e){return console.log(e)}))},j=function(){return k.a.post("/api/auth/logout")},O=y.a.Content,C=y.a.Header,I={labelCol:{span:8},wrapperCol:{span:16}},S={wrapperCol:{offset:8,span:16}},T=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(t){var a=t.username,n=t.password;return w(a,n).then((function(){v.a.success("Login success"),e.props.history.push("/app")}))},e.onFinishFailed=function(e){v.a.error("Invalid username or password")},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(y.a,{style:{width:"100",height:"100%"}},r.a.createElement(C,null,r.a.createElement("h1",{style:{color:"#ffffff",display:"flex",justifyContent:"space-around"}},"Login to system")),r.a.createElement(O,{style:{width:"45%",minWidth:350,position:"absolute",top:"20%",left:"20%"}},r.a.createElement(b.a,{style:{fontSize:50,margin:"20px 60%"}}),r.a.createElement(f.a,Object.assign({},I,{name:"basic",initialValues:{remember:!0},onFinish:this.onFinish,onFinishFailed:this.onFinishFailed}),r.a.createElement(f.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(E.a,null)),r.a.createElement(f.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(E.a.Password,null)),r.a.createElement(f.a.Item,Object.assign({},S,{name:"remember",valuePropName:"checked"}),r.a.createElement(h.a,null,"Remember me")),r.a.createElement(f.a.Item,S,r.a.createElement(p.a,{type:"primary",htmlType:"submit"},"Submit")))))}}]),a}(r.a.Component),L=Object(d.g)(T),P=(a(178),a(110)),x=(a(414),a(22)),D=a(416),F=a(417),A=a(418),R=function(e){var t=e.username,a=e.password,n=e.role;return k.a.post("/api/users/create",{username:t,password:a,role:n})},q=function(){return k.a.get("/api/users/all")},M=x.a.SubMenu,B=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={username:"",role:""},e.requestLogout=function(){var t=e.props.history;j().then((function(){return t.push("/login")}))},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;k.a.get("/api/users/my").then((function(t){var a=t.data;e.setState({username:a.username,role:a.role})}))}},{key:"render",value:function(){var e=this.state,t=e.username,a=e.role;return r.a.createElement(x.a,{style:{width:256},defaultSelectedKeys:["3"],defaultOpenKeys:["sub2"],mode:"inline"},r.a.createElement(x.a.Item,{onClick:this.requestLogout},r.a.createElement("span",null,r.a.createElement(D.a,null),r.a.createElement("span",null,"Logout, ",t))),["ADMIN","SUPPORTER"].includes(a)&&r.a.createElement(M,{key:"sub1",title:r.a.createElement("span",null,r.a.createElement(F.a,null),r.a.createElement("span",null,"Users"))},r.a.createElement(x.a.Item,{key:"1"},r.a.createElement(m.b,{to:"/app/user-list"},"List all")),r.a.createElement(x.a.Item,{key:"2"},r.a.createElement(m.b,{to:"/app/add-user"},"Add"))),r.a.createElement(M,{key:"sub2",title:r.a.createElement("span",null,r.a.createElement(A.a,null),r.a.createElement("span",null,"Tickets"))},r.a.createElement(x.a.Item,{key:"3"},r.a.createElement(m.b,{to:"/app/ticket-list"},"Ticket List")),r.a.createElement(x.a.Item,{key:"4"},r.a.createElement(m.b,{to:"/app/add-ticket"},"Add Ticket"))))}}]),a}(r.a.Component),U=Object(d.g)(B),z=(a(180),a(40)),_=a(46),W=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(e){return R(Object(_.a)({},e)).then((function(){return v.a.success("Create user success")}))},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{style:{padding:10,width:"100%"}},r.a.createElement("h1",null,"Add user"),r.a.createElement(f.a,{labelCol:{span:4},wrapperCol:{span:14},layout:"horizontal",style:{maxWidth:600},size:"middle",onFinish:this.onFinish},r.a.createElement(f.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input username!"}]},r.a.createElement(E.a,null)),r.a.createElement(f.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input password!"}]},r.a.createElement(E.a.Password,null)),r.a.createElement(f.a.Item,{label:"Role",name:"role",rules:[{required:!0,message:"Please choose a role!"}]},r.a.createElement(z.a,null,r.a.createElement(z.a.Option,{value:"ADMIN"},"Admin"),r.a.createElement(z.a.Option,{value:"SUPPORTER"},"Supporter"),r.a.createElement(z.a.Option,{value:"USER"},"User"))),r.a.createElement(f.a.Item,{wrapperCol:{offset:4}},r.a.createElement(p.a,{type:"primary",htmlType:"submit"},"Submit"))))}}]),a}(r.a.Component),$=(a(183),a(111)),H=[{title:"Username",dataIndex:"username",key:"username"},{title:"Role",dataIndex:"role",key:"role"}],N=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={userList:[]},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;q().then((function(t){var a=t.data;return e.setState({userList:a})}))}},{key:"render",value:function(){var e=this.state.userList;return r.a.createElement("div",{style:{width:"100%",padding:10}},r.a.createElement($.a,{dataSource:e,columns:H}))}}]),a}(r.a.Component),J=function(e){var t=e.title,a=e.content;return k.a.post("/api/ticket/create",{title:t,content:a})},K=function(e){return k.a.get("/api/ticket/byId/".concat(e))},V=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(e){J(Object(_.a)({},e)).then((function(){return v.a.success("create ticket success !")}))},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{style:{width:"100%",padding:10}},r.a.createElement("h1",null,"Add Ticket"),r.a.createElement(f.a,{labelCol:{span:4},wrapperCol:{span:14},layout:"horizontal",style:{maxWidth:600},size:"middle",onFinish:this.onFinish},r.a.createElement(f.a.Item,{label:"Title",name:"title",rules:[{required:!0,message:"Please input title!"}]},r.a.createElement(E.a,null)),r.a.createElement(f.a.Item,{label:"Content",name:"content",rules:[{required:!0,message:"Please input content!"}]},r.a.createElement(E.a.TextArea,null)),r.a.createElement(f.a.Item,{wrapperCol:{offset:4}},r.a.createElement(p.a,{type:"primary",htmlType:"submit"},"Submit"))))}}]),a}(r.a.Component),G=a(26),Q=a.n(G),X=a(55),Y=[{title:"Title",dataIndex:"title",key:"title"},{title:"Content",dataIndex:"content",key:"content"},{title:"Created by",dataIndex:"createdBy",key:"createdBy"},{title:"Create time",dataIndex:"createTime",key:"createTime",render:function(e){return"".concat(new Date(e).toLocaleDateString()," - ").concat(new Date(e).toLocaleTimeString())}},{title:"",key:"action",render:function(e){return r.a.createElement(m.b,{to:"/app/ticket/".concat(e._id.$oid)},"View")}}],Z=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={ticketList:[],userList:[]},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(X.a)(Q.a.mark((function e(){var t,a,n,r;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.get("/api/ticket/all").then((function(e){return e.data}));case 2:return t=e.sent,a=t.map((function(e){return e.createdBy})),e.next=6,(l=a,k.a.post("/api/users/getByIds",{ids:l})).then((function(e){return e.data}));case 6:n=e.sent,r=t.map((function(e){var t;return Object(_.a)({},e,{createdBy:null===(t=n.find((function(t){return(null===t||void 0===t?void 0:t._id.$oid)===e.createdBy})))||void 0===t?void 0:t.username})})),this.setState({ticketList:r,userList:n});case 9:case"end":return e.stop()}var l}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.ticketList;return r.a.createElement("div",{style:{width:"100%",padding:10}},r.a.createElement($.a,{dataSource:e,columns:Y}))}}]),a}(r.a.Component),ee=(a(412),a(62)),te=(a(182),a(112)),ae=function(e,t){var a=t.content;return k.a.post("/api/comment/".concat(e),{content:a})},ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return k.a.post("/api/comment/view/".concat(e),{page:t,pageSize:a})},re=function(e){return k.a.delete("/api/comment/".concat(e))},le=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(e=t.call.apply(t,[this].concat(l))).state={ticket:void 0,comments:{},userList:[]},e.getTicketId=function(){return e.props.match.params.id},e.onFinish=function(t){var a=e.getTicketId();ae(a,Object(_.a)({},t)).then((function(e){e.data;v.a.success("Comment posted")}))},e.onDelete=function(e){re(e).then((function(){return v.a.success("delete success")}))},e.onChangePage=function(t,a){var n=e.getTicketId();ne(n,t,a).then((function(t){var a=t.data;return e.setState({comments:a})}))},e.renderComment=function(){var t=e.state,a=t.comments,n=t.userList;return console.log(n),a&&0!==a.data.length?r.a.createElement("div",null,a.data.map((function(t){var a;return r.a.createElement("div",{key:t._id.$oid},r.a.createElement("span",{style:{marginRight:10}},r.a.createElement("b",null,null===(a=n[t.userId])||void 0===a?void 0:a.username),"("," ",r.a.createElement("span",{style:{paddingRight:10}},new Date(t.createTime).toLocaleDateString()),r.a.createElement("span",null,new Date(t.createTime).toLocaleTimeString()),"):"),r.a.createElement("span",null,t.content),r.a.createElement("span",{style:{marginLeft:15,cursor:"pointer"},onClick:function(){return e.onDelete(t._id.$oid)}},"Delete"))})),r.a.createElement(te.a,{defaultCurrent:1,total:a.total,onChange:e.onChangePage})):r.a.createElement("span",null,"No comments")},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=Object(X.a)(Q.a.mark((function e(){var t,a,n,r,l;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.getTicketId())){e.next=14;break}return e.next=4,K(t).then((function(e){return e.data}));case 4:return a=e.sent,e.next=7,ne(t).then((function(e){return e.data}));case 7:return n=e.sent,e.next=10,q().then((function(e){return e.data}));case 10:r=e.sent,l=[],r.map((function(e){return l[e._id.$oid]=Object(_.a)({},e)})),this.setState({ticket:a,comments:n,userList:l});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this.state,a=t.ticket,n=t.userList;return a?r.a.createElement("div",{style:{width:"100%",padding:10}},r.a.createElement(P.a,null,r.a.createElement(ee.a,{span:24},r.a.createElement("h1",null,"Title: ",a.title)),r.a.createElement(ee.a,{span:24},r.a.createElement("h1",null,"Time: ",new Date(a.createTime).toLocaleDateString()," -",new Date(a.createTime).toLocaleTimeString())),r.a.createElement(ee.a,{span:24},r.a.createElement("h1",null,"Created by: ",null===(e=n[a.createdBy])||void 0===e?void 0:e.username)),r.a.createElement(ee.a,{span:24},r.a.createElement("h1",null,"Content: ",a.content)),r.a.createElement(ee.a,{span:24},this.renderComment()),r.a.createElement(ee.a,{span:24},r.a.createElement(f.a,{labelCol:{span:4},wrapperCol:{span:14},layout:"horizontal",style:{maxWidth:600},size:"middle",onFinish:this.onFinish},r.a.createElement(f.a.Item,{label:"Comment",name:"content",rules:[{required:!0,message:"Please input comment!"}]},r.a.createElement(E.a.TextArea,null)),r.a.createElement(f.a.Item,{wrapperCol:{offset:4}},r.a.createElement(p.a,{type:"primary",htmlType:"submit"},"Submit")))))):null}}]),a}(r.a.Component),ce=Object(d.g)(le),oe=y.a.Header,ie=y.a.Content,se=y.a.Footer,ue=y.a.Sider,me=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(y.a,{style:{height:"100%"}},r.a.createElement(oe,{style:{backgroundColor:"#00695c"}},r.a.createElement("h1",{style:{color:"#ffffff",display:"flex",justifyContent:"space-around"}},"DEMO")),r.a.createElement(y.a,null,r.a.createElement(ue,{width:256,style:{backgroundColor:"#ffff"}},r.a.createElement(U,null)),r.a.createElement(ie,null,r.a.createElement(P.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/app/add-user"},r.a.createElement(W,null)),r.a.createElement(d.b,{path:"/app/user-list"},r.a.createElement(N,null)),r.a.createElement(d.b,{path:"/app/add-ticket"},r.a.createElement(V,null)),r.a.createElement(d.b,{path:"/app/ticket-list"},r.a.createElement(Z,null)),r.a.createElement(d.b,{path:"/app/ticket/:id"},r.a.createElement(ce,null)),r.a.createElement(d.a,{to:"/app/ticket-list"}))))),r.a.createElement(se,{style:{backgroundColor:"#00695c",color:"#ffffff"}},r.a.createElement("h3",{style:{color:"#ffffff"}},"Demo - nguyenphuc9119@gmail.com")))}}]),a}(r.a.Component),de=Object(d.g)(me);k.a.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)}));var pe=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).requestInterceptor=void 0,e.responseInterceptor=void 0,e.state={error:void 0,hasError:!1},e._unhandledRejectionEventHandler=function(t){var a,n;"undefined"!==typeof PromiseRejectionEvent&&t instanceof PromiseRejectionEvent?(a=t.reason&&t.reason.response,n=t.reason?t.reason.response:void 0):t instanceof CustomEvent&&(a=t.detail&&t.detail.reason&&t.detail.reason.response,n=t.detail&&t.detail.reason?t.detail.reason.response:void 0),a&&e.handlePromiseResponseError(n)},e.handlePromiseResponseError=function(t){t.status>=500?v.a.error("Server connection error"):e.processExpectedServerError(t)},e.processExpectedServerError=function(t){t&&(t.data&&t.data.message?v.a.error(t.data.message):t&&401===t.status&&(window.location.pathname.includes("/login")?e.setState({error:void 0}):(v.a.error("401: Permission deny"),window.location.href="/login")))},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("unhandledrejection",this._unhandledRejectionEventHandler)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("unhandledrejection",this._unhandledRejectionEventHandler)}},{key:"render",value:function(){return this.props.children}}]),a}(r.a.Component),he=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(pe,null,r.a.createElement(m.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/login"},r.a.createElement(L,null)),r.a.createElement(d.b,{path:"/app"},r.a.createElement(de,null)),r.a.createElement(d.a,{to:"/app"}))))}}]),a}(r.a.PureComponent);var fe=function(){return r.a.createElement("div",{style:{width:"100%",height:"100%"}},r.a.createElement(he,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(fe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[206,1,2]]]);
//# sourceMappingURL=main.584883cf.chunk.js.map